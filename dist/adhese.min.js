function Adhese(){return this.config={debug:!1},this.request={},this.ads=[],this.that=this,this.helper=new this.Helper,this.detection=new this.Detection,this}function AdheseVastWrapper(e){this.debug=void 0!=e?e:!1}function AdheseVastAd(e,t,r,n,i,o,s){this.id=e,this.mediafile=t,this.duration=r,this.impression=n,this.durationInSeconds=i,this.trackers=o,this.click=s}function AdheseVastMediaFile(e,t){this.src=e,this.type=t}function AdheseVastEventListener(e,t){this.event=e,this.listener=t}function AdheseVastHelper(){}Adhese.prototype.Ad=function(e,t,r){var n={write:!1};return this.format=t,this.options=e.helper.merge(n,r),this},Adhese.prototype.init=function(e){e.debug&&(this.config.debug=e.debug),this.config.debug&&this.helper.log("Adhese: initializing..."),this.config.jquery="undefined"!=typeof jQuery,e.host&&(this.config.host=e.host),e.location&&"function"==typeof e.location?this.config.location=e.location():e.location&&"string"==typeof e.location&&(this.config.location=e.location),this.registerRequestParameter("rn",Math.round(1e4*Math.random())),"function"==typeof Fingerprint&&this.registerRequestParameter("fp",new Fingerprint({canvas:!0}).get()),this.registerRequestParameter("pr",window.devicePixelRatio||1),this.registerRequestParameter("re",this.helper.stringToHex(document.referrer)),this.userAgent=this.helper.getUserAgent();for(var t in this.userAgent)this.registerRequestParameter("br",this.userAgent[t]);"function"==typeof this.Detection&&this.registerRequestParameter("dt",this.detection.device()),this.config.debug&&(this.helper.log("Adhese: initialized with config:"),this.helper.log(this.config))},Adhese.prototype.registerRequestParameter=function(e,t){var r=this.request[e];r||(r=new Array),r.push(t),this.request[e]=r},Adhese.prototype.tag=function(e,t){var r=new this.Ad(this,e,t);return this.ads.push([e,r]),r.options.write&&this.write(r),r},Adhese.prototype.write=function(e){this.config.debug&&console.log("Adhese.write: request uri: "+this.getRequestUri(e,{type:"js"})),document.write('<script type="text/javascript" src="'+this.getRequestUri(e,{type:"js"})+'"></script>')},Adhese.prototype.track=function(e){this.helper.addTrackingPixel(e)},Adhese.prototype.getMultipleRequestUri=function(e,t){var r=this.config.host;switch(t||(t={type:"js"}),t.type){case"json":r+="json/";break;case"jsonp":t.callbackFunctionName||(t.callbackFunctionName="callback"),r+="jsonp/"+t.callbackFunctionName+"/";break;default:r+="ad/"}for(var n=e.length-1;n>=0;n--)r+=e[n].options.location?"sl"+e[n].options.location+"-"+e[n].format+"/":"sl"+this.config.location+"-"+e[n].format+"/";for(var i in this.request){for(var o=i,s=0;s<this.request[i].length;s++)o+=this.request[i][s]+(this.request[i].length-1>s?";":"");r+=o+"/"}return r+="?t="+(new Date).getTime()},Adhese.prototype.getRequestUri=function(e,t){var r=[e];return this.getMultipleRequestUri(r,t)},Adhese.prototype.Helper=function(){this.oslist=[{string:navigator.userAgent,subString:"Windows NT 6.2",identity:"Windows8"},{string:navigator.userAgent,subString:"Windows NT 6.1",identity:"Windows7"},{string:navigator.userAgent,subString:"Windows NT 6.0",identity:"WindowsVista"},{string:navigator.userAgent,subString:"Windows NT 5.1",identity:"WindowsXP"},{string:navigator.userAgent,subString:"Windows 98",identity:"Windows98"},{string:navigator.platform,subString:"Linux",identity:"Linux"},{string:navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:navigator.userAgent,subString:"iPad",identity:"iOS"},{string:navigator.platform,subString:"Mac",identity:"OSX"},{string:navigator.userAgent,subString:"Android",identity:"Android"}],this.browserlist=[{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"}],this.devicelist=[{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.userAgent,subString:"Mac",identity:"Mac"}]},Adhese.prototype.Helper.prototype.log=function(e){console.log(e)},Adhese.prototype.Helper.prototype.getMetaTagContent=function(){},Adhese.prototype.Helper.prototype.getQueryStringParameter=function(){var e=RegExp("[?&]"+key+"=([^&]*)").exec(window.location.search);return e?decodeURIComponent(e[1].replace(/\+/g," ")):default_},Adhese.prototype.Helper.prototype.addTrackingPixel=function(e){var t=document.createElement("img");t.src=e+this.timestamp(s),t.style.height="1px",t.style.width="1px",t.style.margin="-1px",t.style.border="0",t.style.position="absolute",t.style.top="0",document.body.appendChild(t)},Adhese.prototype.Helper.prototype.getScreenProperties=function(){var e=new Object;return e.width=window.innerWidth?window.innerWidth:document.body.offsetWidth,e.height=window.innerHeight?window.innerHeight:document.body.offsetHeight,e},Adhese.prototype.Helper.prototype.addEventListener=function(){adhese.config.jquery?$(window).bind(t,f):window.addEventListener?window.addEventListener(t,f,!1):window.attachEvent&&window.attachEvent("on"+t,f)},Adhese.prototype.Helper.prototype.removeEventListener=function(){adhese.config.jquery?$(window).unbind(t,f):window.removeEventListener?window.removeEventListener(t,f,!1):window.detachEvent&&window.detachEvent("on"+t,f)},Adhese.prototype.Helper.prototype.getAbsoluteOffset=function(e){var t={top:0,left:0};if("undefined"!=typeof e)for(t.left=0,t.top=0;e;e=e.offsetParent)t.left+=e.offsetLeft,t.top+=e.offsetTop;return t},Adhese.prototype.Helper.prototype.getUserAgent=function(){var e={};return e.browser=this.searchString(this.browserlist)||"unknownBrowser",e.browserVersion=e.browser+this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"unknownVersion",e.os=this.searchString(this.oslist)||"unknownOS",e},Adhese.prototype.Helper.prototype.searchString=function(e){for(var t=0;t<e.length;t++){var r=e[t].string,n=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,r){if(-1!=r.indexOf(e[t].subString))return e[t].identity}else if(n)return e[t].identity}},Adhese.prototype.Helper.prototype.searchVersion=function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},Adhese.prototype.Helper.prototype.merge=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},Adhese.prototype.Helper.prototype.stringToHex=function(e){var t,r,n="";for(r=0;r<e.length;r++)t=e.charCodeAt(r).toString(16),n+=("000"+t).slice(-4);return n},Adhese.prototype.Helper.prototype.createCookie=function(e,t,r){if(r){var n=new Date;n.setTime(n.getTime()+24*r*60*60*1e3);var i="; expires="+n.toGMTString()}else var i="";document.cookie=e+"="+t+i+"; path=/"},Adhese.prototype.Helper.prototype.readCookie=function(e){for(var t=e+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null},Adhese.prototype.Helper.prototype.eraseCookie=function(e){createCookie(e,"",-1)},Adhese.prototype.Helper.prototype.getMetaContent=function(e){for(var t=document.getElementsByTagName("META"),r=[],n=t.length-1;n>=0;n--){var i=t[n];i&&(i.name===e||i.getAttribute("property")===e)&&i.content&&r.push(i.content)}return r},Adhese.prototype.Helper.prototype.adhElementInViewport=function(e){if("string"==typeof e&&(e=document.getElementById(e)),e){var t=e.getBoundingClientRect();return t.top>=0&&t.left>=0&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}return!1};var AdheseAjax={request:function(e){"string"==typeof e&&(e={url:e}),e.url=e.url||"",e.method=e.method||"get",e.data=e.data||{};var t=function(e,t){var r,n=[];for(var i in e)n.push(i+"="+encodeURIComponent(e[i]));return r=n.join("&"),""!=r?t?t.indexOf("?")<0?"?"+r:"&"+r:r:""},r={host:{},process:function(e){var r=this;this.xhr=null;try{this.xhr=new ActiveXObject("Msxml2.XMLHTTP")}catch(n){try{this.xhr=new ActiveXObject("Microsoft.XMLHTTP")}catch(n){try{this.xhr=new XMLHttpRequest}catch(n){this.xhr=!1}}}return this.xhr&&(this.xhr.onreadystatechange=function(){if(4==r.xhr.readyState&&200==r.xhr.status){var t=r.xhr.responseText;e.json===!0&&"undefined"!=typeof JSON&&(t=JSON.parse(t)),r.doneCallback&&r.doneCallback.apply(r.host,[t,r.xhr])}else 4==r.xhr.readyState&&r.failCallback&&r.failCallback.apply(r.host,[r.xhr]);r.alwaysCallback&&r.alwaysCallback.apply(r.host,[r.xhr])}),"get"==e.method?this.xhr.open("GET",e.url+t(e.data,e.url),!0):(this.xhr.open(e.method,e.url,!0),this.setHeaders({"X-Requested-With":"XMLHttpRequest","Content-type":"application/x-www-form-urlencoded"})),e.headers&&"object"==typeof e.headers&&this.setHeaders(e.headers),setTimeout(function(){"get"==e.method?r.xhr.send():r.xhr.send(t(e.data))},20),this},done:function(e){return this.doneCallback=e,this},fail:function(e){return this.failCallback=e,this},always:function(e){return this.alwaysCallback=e,this},setHeaders:function(e){for(var t in e)this.xhr&&this.xhr.setRequestHeader(t,e[t])}};return r.process(e)}};Adhese.prototype.Detection=function(){return this},Adhese.prototype.Detection.prototype.device=function(e){return e=e?e:window.navigator.userAgent,this.deviceType=e.match(/webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini|Mobile Safari|SymbianOS/i)&&!e.match(/Android/i)?"phone":e.match(/Mobile/i)&&e.match(/Android/i)?"phone":e.match(/iPad|Android|Tablet|Silk/i)?"tablet":"desktop",this.deviceType},function(e,t,r){"undefined"!=typeof module&&module.exports?module.exports=r():"function"==typeof define&&define.amd?define(r):t[e]=r()}("Fingerprint",this,function(){"use strict";var e=function(e){var t,r;t=Array.prototype.forEach,r=Array.prototype.map,this.each=function(e,r,n){if(null!==e)if(t&&e.forEach===t)e.forEach(r,n);else if(e.length===+e.length){for(var i=0,o=e.length;o>i;i++)if(r.call(n,e[i],i,e)==={})return}else for(var s in e)if(e.hasOwnProperty(s)&&r.call(n,e[s],s,e)==={})return},this.map=function(e,t,n){var i=[];return null==e?i:r&&e.map===r?e.map(t,n):(this.each(e,function(e,r,o){i[i.length]=t.call(n,e,r,o)}),i)},"object"==typeof e?(this.hasher=e.hasher,this.screen_resolution=e.screen_resolution,this.canvas=e.canvas,this.ie_activex=e.ie_activex):"function"==typeof e&&(this.hasher=e)};return e.prototype={get:function(){var e=[];if(e.push(navigator.userAgent),e.push(navigator.language),e.push(screen.colorDepth),this.screen_resolution){var t=this.getScreenResolution();"undefined"!=typeof t&&e.push(this.getScreenResolution().join("x"))}return e.push((new Date).getTimezoneOffset()),e.push(this.hasSessionStorage()),e.push(this.hasLocalStorage()),e.push(!!window.indexedDB),e.push(document.body?typeof document.body.addBehavior:"undefined"),e.push(typeof window.openDatabase),e.push(navigator.cpuClass),e.push(navigator.platform),e.push(navigator.doNotTrack),e.push(this.getPluginsString()),this.canvas&&this.isCanvasSupported()&&e.push(this.getCanvasFingerprint()),this.hasher?this.hasher(e.join("###"),31):this.murmurhash3_32_gc(e.join("###"),31)},murmurhash3_32_gc:function(e,t){var r,n,i,o,s,a,h,d;for(r=3&e.length,n=e.length-r,i=t,s=3432918353,a=461845907,d=0;n>d;)h=255&e.charCodeAt(d)|(255&e.charCodeAt(++d))<<8|(255&e.charCodeAt(++d))<<16|(255&e.charCodeAt(++d))<<24,++d,h=(65535&h)*s+(((h>>>16)*s&65535)<<16)&4294967295,h=h<<15|h>>>17,h=(65535&h)*a+(((h>>>16)*a&65535)<<16)&4294967295,i^=h,i=i<<13|i>>>19,o=5*(65535&i)+((5*(i>>>16)&65535)<<16)&4294967295,i=(65535&o)+27492+(((o>>>16)+58964&65535)<<16);switch(h=0,r){case 3:h^=(255&e.charCodeAt(d+2))<<16;case 2:h^=(255&e.charCodeAt(d+1))<<8;case 1:h^=255&e.charCodeAt(d),h=(65535&h)*s+(((h>>>16)*s&65535)<<16)&4294967295,h=h<<15|h>>>17,h=(65535&h)*a+(((h>>>16)*a&65535)<<16)&4294967295,i^=h}return i^=e.length,i^=i>>>16,i=2246822507*(65535&i)+((2246822507*(i>>>16)&65535)<<16)&4294967295,i^=i>>>13,i=3266489909*(65535&i)+((3266489909*(i>>>16)&65535)<<16)&4294967295,i^=i>>>16,i>>>0},hasLocalStorage:function(){try{return!!window.localStorage}catch(e){return!0}},hasSessionStorage:function(){try{return!!window.sessionStorage}catch(e){return!0}},isCanvasSupported:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},isIE:function(){return"Microsoft Internet Explorer"===navigator.appName?!0:"Netscape"===navigator.appName&&/Trident/.test(navigator.userAgent)?!0:!1},getPluginsString:function(){return this.isIE()&&this.ie_activex?this.getIEPluginsString():this.getRegularPluginsString()},getRegularPluginsString:function(){return this.map(navigator.plugins,function(e){var t=this.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",");return[e.name,e.description,t].join("::")},this).join(";")},getIEPluginsString:function(){if(window.ActiveXObject){var e=["ShockwaveFlash.ShockwaveFlash","AcroPDF.PDF","PDF.PdfCtrl","QuickTime.QuickTime","rmocx.RealPlayer G2 Control","rmocx.RealPlayer G2 Control.1","RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)","RealVideo.RealVideo(tm) ActiveX Control (32-bit)","RealPlayer","SWCtl.SWCtl","WMPlayer.OCX","AgControl.AgControl","Skype.Detection"];return this.map(e,function(e){try{return new ActiveXObject(e),e}catch(t){return null}}).join(";")}return""},getScreenResolution:function(){return[screen.height,screen.width]},getCanvasFingerprint:function(){var e=document.createElement("canvas"),t=e.getContext("2d"),r="http://valve.github.io";return t.textBaseline="top",t.font="14px 'Arial'",t.textBaseline="alphabetic",t.fillStyle="#f60",t.fillRect(125,1,62,20),t.fillStyle="#069",t.fillText(r,2,15),t.fillStyle="rgba(102, 204, 0, 0.7)",t.fillText(r,4,17),e.toDataURL()}},e}),AdheseVastWrapper.prototype.init=function(){this.eventListeners=new Array,this.trackedImpressions=new Array,this.schedule={},this.helper=new AdheseVastHelper},AdheseVastWrapper.prototype.requestAds=function(e,t,r){var n=e+"/jsonp/a.parseVastJson";for(var i in r)n+="/sl"+t+"-"+r[i];n+="/?t="+(new Date).getTime();var o=document.createElement("script");o.type="text/javascript",o.src=n,document.getElementsByTagName("head")[0].appendChild(o)},AdheseVastWrapper.prototype.parseInLine=function(e){for(var t=new Array,r=e.getElementsByTagName("MediaFile"),n=0;n<r.length;n++)t.push(new AdheseVastMediaFile(r[n].firstChild.nodeValue,r[n].attributes.getNamedItem("type").value));for(var i=new Array,o=e.getElementsByTagName("Impression"),n=0;n<o.length;n++)i.push(o[n].firstChild.nodeValue);for(var s=new Object,a=e.getElementsByTagName("Tracking"),n=0;n<a.length;n++)s[a[n].attributes.getNamedItem("event").nodeValue]||(s[a[n].attributes.getNamedItem("event").value]=new Array),s[a[n].attributes.getNamedItem("event").nodeValue].push(a[n].firstChild.nodeValue);for(var h=e.getElementsByTagName("ClickTracking"),n=0;n<a.length;n++)s.click||(s.click=new Array),h[n]&&h[n].firstChild.nodeValue&&""!=h[n].firstChild.nodeValue&&s.click.push(h[n].firstChild.nodeValue);for(var d="",p=e.getElementsByTagName("ClickThrough"),n=0;n<p.length;n++)d=p[n].firstChild.nodeValue;var u=e.attributes.getNamedItem("code")?e.attributes.getNamedItem("code").value:"preroll";this.debug&&console.log(u);var c,l=e.getElementsByTagName("Duration")[0].firstChild;c=null!==l?e.getElementsByTagName("Duration")[0].firstChild.nodeValue:0,this.schedule[u]=new AdheseVastAd(u,t,c,i,this.helper.getDurationInSeconds(c),s,d),this.debug&&console.log(this.schedule)},AdheseVastWrapper.prototype.parseVastJson=function(e){var t=this.parseXML(e[0].tag),r=t.getElementsByTagName("Ad"),n=this;if(0===r.length)return void this.fireAdsLoaded();for(var i=0;i<r.length;i++)if(r[i].getElementsByTagName("InLine").length>0)this.parseInLine(r[i]),this.fireAdsLoaded();else{var o=r[i].attributes.getNamedItem("code").nodeValue,s=r[i].getElementsByTagName("Impression");AdheseAjax.request({url:r[i].getElementsByTagName("VASTAdTagURI")[0].firstChild.nodeValue,method:"get",json:!1}).done(function(e){for(var t=n.parseXML(e),r=t.getElementsByTagName("Ad"),i=0;i<r.length;i++){r[i].setAttribute("code",o);for(var a=0;a<s.length;a++)r[i].getElementsByTagName("InLine")[0].insertBefore(s[a],r[i].getElementsByTagName("Impression")[0]);r[i].getElementsByTagName("InLine").length>0?n.parseInLine(r[i]):n.debug&&console.log("Too many redirects")}n.fireAdsLoaded()})}},AdheseVastWrapper.prototype.parseXML=function(e){if(this.debug&&console.log(typeof window.DOMParser),"undefined"!=typeof window.DOMParser)return(new window.DOMParser).parseFromString(e,"text/xml");if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}return void 0},AdheseVastWrapper.prototype.addEventListener=function(e,t){this.eventListeners.push(new AdheseVastEventListener(e,t))},AdheseVastWrapper.prototype.fireAdsLoaded=function(){for(var e=0;e<this.eventListeners.length;e++)"ADS_LOADED"==this.eventListeners[e].getEvent()&&(this.debug&&console.log("ADS_LOADED sent to listener"),this.eventListeners[e].getListener().apply())},AdheseVastWrapper.prototype.getSchedule=function(){var e=new Array;for(var t in this.schedule)e.push(t);return e},AdheseVastWrapper.prototype.hasAd=function(e){return void 0!=this.schedule[e]},AdheseVastWrapper.prototype.getImpression=function(e){return this.schedule[e].getImpression()},AdheseVastWrapper.prototype.getClick=function(e){return this.schedule[e].getClick()},AdheseVastWrapper.prototype.getTrackers=function(e){return this.schedule[e].getTrackers()},AdheseVastWrapper.prototype.getMediafile=function(e,t){for(var r=this.schedule[e].getMediafile(),n=0;n<r.length;n++)if(r[n].getType()==t)return r[n].getSrc();return void 0},AdheseVastWrapper.prototype.getDuration=function(e){return this.schedule[e].getDuration()},AdheseVastWrapper.prototype.getDurationInSeconds=function(e){return this.schedule[e].getDurationInSeconds()},AdheseVastWrapper.prototype.track=function(e){for(var t=0;t<e.length;t++)if(!this.trackedImpressions[e[t]]){this.trackedImpressions[e[t]]=1;var r=document.createElement("img");r.src=e[t]+((-1==e[t].indexOf("?")?"?adhche=":"&adhche=")+(new Date).getTime())}},AdheseVastWrapper.prototype.timeupdate=function(e,t){if(this.debug&&console.log(e+" timeupdate @"+t+" sec."),0==t)this.debug&&console.log("Tracking impression for "+e),this.track(this.getImpression(e));else{var r=t/this.schedule[e].getDurationInSeconds();0==r.toFixed(2)?(this.debug&&console.log("Tracking start for "+e),this.track(this.getTrackers(e).start)):.25==r.toFixed(2)?(this.debug&&console.log("Tracking first quartile for "+e+" - "+this.getTrackers(e).firstQuartile),this.track(this.getTrackers(e).firstQuartile)):.5==r.toFixed(2)?(this.debug&&console.log("Tracking mid point for "+e),this.track(this.getTrackers(e).midpoint)):.75==r.toFixed(2)&&(this.debug&&console.log("Tracking third quartile for "+e),this.track(this.getTrackers(e).thirdQuartile))}},AdheseVastWrapper.prototype.clicked=function(e,t){this.debug&&console.log("tracker clicked for "+e+" @"+t),this.debug&&console.log("open new window with VideoClicks>ClickThrough"),this.helper.openNewWindow(this.getClick(e)),this.track(this.getTrackers(e).click)},AdheseVastWrapper.prototype.ended=function(e,t){this.debug&&console.log(e+" ended @"+t),this.debug&&console.log("tracker complete for "+e),this.track(this.getTrackers(e).complete)},AdheseVastAd.prototype.getId=function(){return this.id},AdheseVastAd.prototype.getMediafile=function(){return this.mediafile},AdheseVastAd.prototype.getDuration=function(){return this.duration},AdheseVastAd.prototype.getDurationInSeconds=function(){return this.durationInSeconds},AdheseVastAd.prototype.getImpression=function(){return this.impression},AdheseVastAd.prototype.getTrackers=function(){return this.trackers},AdheseVastAd.prototype.getClick=function(){return this.click},AdheseVastMediaFile.prototype.getSrc=function(){return this.src},AdheseVastMediaFile.prototype.getType=function(){return this.type},AdheseVastEventListener.prototype.getEvent=function(){return this.event},AdheseVastEventListener.prototype.getListener=function(){return this.listener},AdheseVastHelper.prototype.getDurationInSeconds=function(e){if(e){var t=e.split(":");return 3==t.length?parseInt(3600*t[0])+parseInt(60*t[1])+parseInt(t[2]):2==t.length?parseInt(60*t[0])+parseInt(t[1]):1==t.length?parseInt(t[0]):0}return 0},AdheseVastHelper.prototype.openNewWindow=function(e){if(window){var t=window.open(e,"_blank");t.focus()}};