function Adhese(){return this.config={debug:!1},this.request={},this.ads=[],this.that=this,this.helper=new this.Helper,this}function AdheseOpenRTB(){this.approvedCreatives=["creative114","creative112"]}function AdheseVastWrapper(e){this.debug=void 0!=e?e:!1}function AdheseVastAd(e,t,r,i,n,s,o){this.id=e,this.mediafile=t,this.duration=r,this.impression=i,this.durationInSeconds=n,this.trackers=s,this.click=o}function AdheseVastMediaFile(e,t){this.src=e,this.type=t}function AdheseVastEventListener(e,t){this.event=e,this.listener=t}function AdheseVastHelper(){}Adhese.prototype.Ad=function(e,t,r){var i={write:!1};return this.format=t,this.options=e.helper.merge(i,r),this},Adhese.prototype.init=function(e){e.debug&&(this.config.debug=e.debug),this.config.debug&&this.helper.log("Adhese: initializing..."),this.config.jquery="undefined"!=typeof jQuery,e.host&&(this.config.host=e.host),e.location&&"function"==typeof e.location?this.config.location=e.location():e.location&&"string"==typeof e.location&&(this.config.location=e.location),this.userAgent=this.helper.getUserAgent(),this.registerRequestParameter("rn",Math.round(1e4*Math.random())),this.registerRequestParameter("br","screen3"),this.registerRequestParameter("br","desktop");for(var t in this.userAgent)this.registerRequestParameter("br",this.userAgent[t]);this.config.debug&&(this.helper.log("Adhese: initialized with config:"),this.helper.log(this.config))},Adhese.prototype.registerRequestParameter=function(e,t){var r=this.request[e];r||(r=new Array),r.push(t),this.request[e]=r},Adhese.prototype.tag=function(e,t){var r=new this.Ad(this,e,t);return this.ads.push([e,r]),r.options.write&&this.write(r),r},Adhese.prototype.write=function(e){this.config.debug&&console.log("Adhese.write: request uri: "+this.getRequestUri(e,{type:"js"})),document.write('<script type="text/javascript" src="'+this.getRequestUri(e,{type:"js"})+'"></script>')},Adhese.prototype.track=function(e){this.helper.addTrackingPixel(e)},Adhese.prototype.getMultipleRequestUri=function(e,t){var r=this.config.host;switch(t||(t={type:"js"}),t.type){case"json":r+="json/";break;case"jsonp":t.callbackFunctionName||(t.callbackFunctionName="callback"),r+="jsonp/"+t.callbackFunctionName+"/";break;default:r+="ad/"}for(var i=e.length-1;i>=0;i--)r+="sl"+this.config.location+"-"+e[i].format+"/";for(var n in this.request){for(var s=n,o=0;o<this.request[n].length;o++)s+=this.request[n][o]+(this.request[n].length-1>o?";":"");r+=s+"/"}return r+="?t="+(new Date).getTime()},Adhese.prototype.getRequestUri=function(e,t){var r=[e];return this.getMultipleRequestUri(r,t)},Adhese.prototype.Helper=function(){this.oslist=[{string:navigator.userAgent,subString:"Windows NT 6.2",identity:"Windows8"},{string:navigator.userAgent,subString:"Windows NT 6.1",identity:"Windows7"},{string:navigator.userAgent,subString:"Windows NT 6.0",identity:"WindowsVista"},{string:navigator.userAgent,subString:"Windows NT 5.1",identity:"WindowsXP"},{string:navigator.userAgent,subString:"Windows 98",identity:"Windows98"},{string:navigator.platform,subString:"Linux",identity:"Linux"},{string:navigator.userAgent,subString:"iPhone",identity:"iOS"},{string:navigator.userAgent,subString:"iPad",identity:"iOS"},{string:navigator.platform,subString:"Mac",identity:"OSX"},{string:navigator.userAgent,subString:"Android",identity:"Android"}],this.browserlist=[{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{prop:window.opera,identity:"Opera"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"}],this.devicelist=[{string:navigator.userAgent,subString:"iPad",identity:"iPad"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.userAgent,subString:"Mac",identity:"Mac"}]},Adhese.prototype.Helper.prototype.log=function(e){console.log(e)},Adhese.prototype.Helper.prototype.getMetaTagContent=function(){},Adhese.prototype.Helper.prototype.getQueryStringParameter=function(){var e=RegExp("[?&]"+key+"=([^&]*)").exec(window.location.search);return e?decodeURIComponent(e[1].replace(/\+/g," ")):default_},Adhese.prototype.Helper.prototype.addTrackingPixel=function(e){var t=document.createElement("img");t.src=e+this.timestamp(s),t.style.height="1px",t.style.width="1px",t.style.margin="-1px",t.style.border="0",t.style.position="absolute",t.style.top="0",document.body.appendChild(t)},Adhese.prototype.Helper.prototype.getScreenProperties=function(){var e=new Object;return e.width=window.innerWidth?window.innerWidth:document.body.offsetWidth,e.height=window.innerHeight?window.innerHeight:document.body.offsetHeight,e},Adhese.prototype.Helper.prototype.addEventListener=function(){adhese.config.jquery?$(window).bind(t,f):window.addEventListener?window.addEventListener(t,f,!1):window.attachEvent&&window.attachEvent("on"+t,f)},Adhese.prototype.Helper.prototype.removeEventListener=function(){adhese.config.jquery?$(window).unbind(t,f):window.removeEventListener?window.removeEventListener(t,f,!1):window.detachEvent&&window.detachEvent("on"+t,f)},Adhese.prototype.Helper.prototype.getAbsoluteOffset=function(e){var t={top:0,left:0};if("undefined"!=typeof e)for(t.left=0,t.top=0;e;e=e.offsetParent)t.left+=e.offsetLeft,t.top+=e.offsetTop;return t},Adhese.prototype.Helper.prototype.getUserAgent=function(){var e={};return e.browser=this.searchString(this.browserlist)||"unknownBrowser",e.browserVersion=e.browser+this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"unknownVersion",e.os=this.searchString(this.oslist)||"unknownOS",e},Adhese.prototype.Helper.prototype.searchString=function(e){for(var t=0;t<e.length;t++){var r=e[t].string,i=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,r){if(-1!=r.indexOf(e[t].subString))return e[t].identity}else if(i)return e[t].identity}},Adhese.prototype.Helper.prototype.searchVersion=function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},Adhese.prototype.Helper.prototype.merge=function(e,t){var r={};for(var i in e)r[i]=e[i];for(var i in t)r[i]=t[i];return r},AdheseOpenRTB.prototype.init=function(){this.bidders=["http://pool.demo.adhese.com/openrtb/bidResponseExample.json","http://pool.demo.adhese.com/openrtb/bidResponseExample2.json","http://pool.demo.adhese.com/openrtb/bidResponseExample3.json"]},AdheseOpenRTB.prototype.getBidRequest=function(){},AdheseOpenRTB.prototype.doBidRequests=function(e){this.bids=new Array,this.notApprovedIncr=0;for(var t=this,r=0;r<this.bidders.length;r++){AdheseAjax.request({url:this.bidders[r],method:"post",json:!0}).done(function(r){document.getElementById("debug").innerHTML+="bid from crid "+r.seatbid[0].bid[0].crid+" at "+r.seatbid[0].bid[0].price+r.cur+"<br/>",document.getElementById("debug").innerHTML+="crid approved: "+(-1!=t.approvedCreatives.indexOf(r.seatbid[0].bid[0].crid))+"<br/>",-1!=t.approvedCreatives.indexOf(r.seatbid[0].bid[0].crid)?t.bids.push({price:Math.round(100*r.seatbid[0].bid[0].price),adm:decodeURIComponent(r.seatbid[0].bid[0].adm),crid:r.seatbid[0].bid[0].crid}):(t.notApprovedIncr++,document.getElementById("approvalQueue").innerHTML+="<a href='javascript:approveCreative(\""+r.seatbid[0].bid[0].crid+"\")'>approve creative now</a><br/>"+decodeURIComponent(r.seatbid[0].bid[0].adm)+"<br/>"),t.bids.length+t.notApprovedIncr==t.bidders.length&&(t.bids.sort(function(e,t){return t.price-e.price}),document.getElementById(e).innerHTML=t.bids[0].adm,document.getElementById("debug").innerHTML+="winning bid: "+t.bids[0].crid)})}};var AdheseAjax={request:function(e){"string"==typeof e&&(e={url:e}),e.url=e.url||"",e.method=e.method||"get",e.data=e.data||{};var t=function(e,t){var r,i=[];for(var n in e)i.push(n+"="+encodeURIComponent(e[n]));return r=i.join("&"),""!=r?t?t.indexOf("?")<0?"?"+r:"&"+r:r:""},r={host:{},process:function(e){var r=this;return this.xhr=null,window.ActiveXObject?this.xhr=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(this.xhr=new XMLHttpRequest),this.xhr&&(this.xhr.onreadystatechange=function(){if(4==r.xhr.readyState&&200==r.xhr.status){var t=r.xhr.responseText;e.json===!0&&"undefined"!=typeof JSON&&(t=JSON.parse(t)),r.doneCallback&&r.doneCallback.apply(r.host,[t,r.xhr])}else 4==r.xhr.readyState&&r.failCallback&&r.failCallback.apply(r.host,[r.xhr]);r.alwaysCallback&&r.alwaysCallback.apply(r.host,[r.xhr])}),"get"==e.method?this.xhr.open("GET",e.url+t(e.data,e.url),!0):(this.xhr.open(e.method,e.url,!0),this.setHeaders({"X-Requested-With":"XMLHttpRequest","Content-type":"application/x-www-form-urlencoded"})),e.headers&&"object"==typeof e.headers&&this.setHeaders(e.headers),setTimeout(function(){"get"==e.method?r.xhr.send():r.xhr.send(t(e.data))},20),this},done:function(e){return this.doneCallback=e,this},fail:function(e){return this.failCallback=e,this},always:function(e){return this.alwaysCallback=e,this},setHeaders:function(e){for(var t in e)this.xhr&&this.xhr.setRequestHeader(t,e[t])}};return r.process(e)}};AdheseVastWrapper.prototype.init=function(){this.eventListeners=new Array,this.trackedImpressions=new Array,this.schedule={},this.helper=new AdheseVastHelper},AdheseVastWrapper.prototype.requestAds=function(e,t,r){var i=e+"/jsonp/a.parseVastJson";for(var n in r)i+="/sl"+t+"-"+r[n];i+="/?t="+(new Date).getTime();var s=document.createElement("script");s.type="text/javascript",s.src=i,document.getElementsByTagName("head")[0].appendChild(s)},AdheseVastWrapper.prototype.parseInLine=function(e){for(var t=new Array,r=e.getElementsByTagName("MediaFile"),i=0;i<r.length;i++)t.push(new AdheseVastMediaFile(r[i].firstChild.nodeValue,r[i].attributes.getNamedItem("type").nodeValue));for(var n=new Array,s=e.getElementsByTagName("Impression"),i=0;i<s.length;i++)n.push(s[i].firstChild.nodeValue);for(var o=new Object,a=e.getElementsByTagName("Tracking"),i=0;i<a.length;i++)o[a[i].attributes.getNamedItem("event").nodeValue]||(o[a[i].attributes.getNamedItem("event").nodeValue]=new Array),o[a[i].attributes.getNamedItem("event").nodeValue].push(a[i].firstChild.nodeValue);for(var d=e.getElementsByTagName("ClickTracking"),i=0;i<a.length;i++)o.click||(o.click=new Array),d[i]&&d[i].firstChild.nodeValue&&""!=d[i].firstChild.nodeValue&&o.click.push(d[i].firstChild.nodeValue);for(var h="",p=e.getElementsByTagName("ClickThrough"),i=0;i<p.length;i++)h=p[i].firstChild.nodeValue;var u=e.attributes.getNamedItem("code")?e.attributes.getNamedItem("code").nodeValue:"preroll";this.debug&&console.log(u),this.schedule[u]=new AdheseVastAd(u,t,e.getElementsByTagName("Duration")[0].firstChild.nodeValue,n,this.helper.getDurationInSeconds(e.getElementsByTagName("Duration")[0].firstChild.nodeValue),o,h),this.debug&&console.log(this.schedule)},AdheseVastWrapper.prototype.parseVastJson=function(e){for(var t=this.parseXML(e[0].tag),r=t.getElementsByTagName("Ad"),i=this,n=0;n<r.length;n++)if(r[n].getElementsByTagName("InLine").length>0)this.parseInLine(r[n]);else{var s=r[n].attributes.getNamedItem("code").nodeValue,o=r[n].getElementsByTagName("Impression");AdheseAjax.request({url:r[n].getElementsByTagName("VASTAdTagURI")[0].firstChild.nodeValue,method:"get",json:!1}).done(function(e){for(var t=i.parseXML(e),r=t.getElementsByTagName("Ad"),n=0;n<r.length;n++){r[n].setAttribute("code",s);for(var a=0;a<o.length;a++)r[n].getElementsByTagName("InLine")[0].insertBefore(o[a],r[n].getElementsByTagName("Impression")[0]);r[n].getElementsByTagName("InLine").length>0?i.parseInLine(r[n]):i.debug&&console.log("Too many redirects")}i.fireAdsLoaded()})}this.fireAdsLoaded()},AdheseVastWrapper.prototype.parseXML=function(e){if(this.debug&&console.log(typeof window.DOMParser),"undefined"!=typeof window.DOMParser)return(new window.DOMParser).parseFromString(e,"text/xml");if("undefined"!=typeof window.ActiveXObject&&new window.ActiveXObject("Microsoft.XMLDOM")){var t=new window.ActiveXObject("Microsoft.XMLDOM");return t.async="false",t.loadXML(e),t}return void 0},AdheseVastWrapper.prototype.addEventListener=function(e,t){this.eventListeners.push(new AdheseVastEventListener(e,t))},AdheseVastWrapper.prototype.fireAdsLoaded=function(){for(var e=0;e<this.eventListeners.length;e++)"ADS_LOADED"==this.eventListeners[e].getEvent()&&(this.debug&&console.log("ADS_LOADED sent to listener"),this.eventListeners[e].getListener().apply())},AdheseVastWrapper.prototype.getSchedule=function(){var e=new Array;for(var t in this.schedule)e.push(t);return e},AdheseVastWrapper.prototype.hasAd=function(e){return void 0!=this.schedule[e]},AdheseVastWrapper.prototype.getImpression=function(e){return this.schedule[e].getImpression()},AdheseVastWrapper.prototype.getClick=function(e){return this.schedule[e].getClick()},AdheseVastWrapper.prototype.getTrackers=function(e){return this.schedule[e].getTrackers()},AdheseVastWrapper.prototype.getMediafile=function(e,t){for(var r=this.schedule[e].getMediafile(),i=0;i<r.length;i++)if(r[i].getType()==t)return r[i].getSrc();return void 0},AdheseVastWrapper.prototype.getDuration=function(e){return this.schedule[e].getDuration()},AdheseVastWrapper.prototype.getDurationInSeconds=function(e){return this.schedule[e].getDurationInSeconds()},AdheseVastWrapper.prototype.track=function(e){for(var t=0;t<e.length;t++)if(!this.trackedImpressions[e[t]]){this.trackedImpressions[e[t]]=1;var r=document.createElement("img");r.src=e[t]+((-1==e[t].indexOf("?")?"?adhche=":"&adhche=")+(new Date).getTime())}},AdheseVastWrapper.prototype.timeupdate=function(e,t){if(this.debug&&console.log(e+" timeupdate @"+t+" sec."),0==t)this.debug&&console.log("Tracking impression for "+e),this.track(this.getImpression(e));else{var r=t/this.schedule[e].getDurationInSeconds();0==r.toFixed(2)?(this.debug&&console.log("Tracking start for "+e),this.track(this.getTrackers(e).start)):.25==r.toFixed(2)?(this.debug&&console.log("Tracking first quartile for "+e+" - "+this.getTrackers(e).firstQuartile),this.track(this.getTrackers(e).firstQuartile)):.5==r.toFixed(2)?(this.debug&&console.log("Tracking mid point for "+e),this.track(this.getTrackers(e).midpoint)):.75==r.toFixed(2)&&(this.debug&&console.log("Tracking third quartile for "+e),this.track(this.getTrackers(e).thirdQuartile))}},AdheseVastWrapper.prototype.clicked=function(e,t){this.debug&&console.log("tracker clicked for "+e+" @"+t),this.debug&&console.log("open new window with VideoClicks>ClickThrough"),this.helper.openNewWindow(this.getClick(e)),this.track(this.getTrackers(e).click)},AdheseVastWrapper.prototype.ended=function(e,t){this.debug&&console.log(e+" ended @"+t),this.debug&&console.log("tracker complete for "+e),this.track(this.getTrackers(e).complete)},AdheseVastAd.prototype.getId=function(){return this.id},AdheseVastAd.prototype.getMediafile=function(){return this.mediafile},AdheseVastAd.prototype.getDuration=function(){return this.duration},AdheseVastAd.prototype.getDurationInSeconds=function(){return this.durationInSeconds},AdheseVastAd.prototype.getImpression=function(){return this.impression},AdheseVastAd.prototype.getTrackers=function(){return this.trackers},AdheseVastAd.prototype.getClick=function(){return this.click},AdheseVastMediaFile.prototype.getSrc=function(){return this.src},AdheseVastMediaFile.prototype.getType=function(){return this.type},AdheseVastEventListener.prototype.getEvent=function(){return this.event},AdheseVastEventListener.prototype.getListener=function(){return this.listener},AdheseVastHelper.prototype.getDurationInSeconds=function(e){if(e){var t=e.split(":");return 3==t.length?parseInt(3600*t[0])+parseInt(60*t[1])+parseInt(t[2]):2==t.length?parseInt(60*t[0])+parseInt(t[1]):1==t.length?parseInt(t[0]):0}return 0},AdheseVastHelper.prototype.openNewWindow=function(e){if(window){var t=window.open(e,"_blank");t.focus()}};